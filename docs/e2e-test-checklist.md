# E2Eテストチェックリスト

このドキュメントは、Browser ToolkitのChrome拡張機能として手動E2Eテストを実行するためのチェックリストです。

## 📋 準備

### 1. 拡張機能のビルド

```bash
pnpm run build
```

### 2. Chrome拡張機能としてロード

1. Chromeで `chrome://extensions/` を開く
2. 「デベロッパーモード」を有効化
3. 「パッケージ化されていない拡張機能を読み込む」をクリック
4. `browser-toolkit` ディレクトリを選択

### 3. 設定の初期化

1. 拡張機能アイコンをクリック → Popupを開く
2. 「設定」タブに移動
3. **AIプロバイダー設定**:
   - プロバイダー: OpenAI / Anthropic / z.ai から選択
   - APIトークン: 有効なトークンを入力
   - モデル: 適切なモデルを選択
4. 「トークンをテスト」ボタンをクリック → ✅ 成功を確認

---

## ✅ テストケース

### 1. テーブルソート機能

#### 1.1 手動ボタンによるソート

- [ ] **準備**: [HTML Table Generator](https://www.tablesgenerator.com/html_tables) で3列×5行のテーブルを生成
- [ ] ページにテーブルを配置
- [ ] Popupを開き「テーブルソート」タブに移動
- [ ] 「このページでテーブルソート機能を有効化」ボタンをクリック
- [ ] **期待**: ページのテーブルヘッダーに「⬍」ボタンが追加される
- [ ] 各列のヘッダーボタンをクリック
- [ ] **期待**: 列が昇順/降順にソートされる
- [ ] 数値列、テキスト列、日付列でソート動作を確認

#### 1.2 自動ソート（パターンマッチ）

- [ ] Popupの「テーブルソート」タブで「パターンを追加」
- [ ] パターン: `*table*` (ワイルドカード)
- [ ] 「保存」をクリック
- [ ] テーブルを含むページ（例: Wikipedia）を開く
- [ ] **期待**: ページロード時に自動的にソートボタンが追加される
- [ ] リロードして再度確認

#### 1.3 動的テーブルの検出

- [ ] ページに最初はテーブルがない状態で開く
- [ ] JavaScriptで動的にテーブルを追加
- [ ] **期待**: MutationObserverが検出し、ソートボタンが自動追加される

---

### 2. Context Actions

#### 2.1 テキスト要約

- [ ] Webページでテキストを選択（200文字以上推奨）
- [ ] 右クリック → 「Context Actions」→「要約」を選択
- [ ] **期待**: オーバーレイUIが表示され、要約結果が表示される
- [ ] オーバーレイに以下が含まれることを確認:
  - [ ] 要約テキスト（箇条書き形式）
  - [ ] ソース情報（タイトル、URL）
  - [ ] クリップボードにコピーボタン

#### 2.2 カスタムアクション

- [ ] Popupを開き「Context Actions」タブに移動
- [ ] 「新規アクション」をクリック
- [ ] 以下を入力:
  - [ ] タイトル: "日本語に翻訳"
  - [ ] プロンプト: "次のテキストを日本語に翻訳してください: {{text}}"
- [ ] 「保存」をクリック
- [ ] 英語テキストを選択 → 右クリック → 「日本語に翻訳」
- [ ] **期待**: 翻訳結果がオーバーレイに表示される

#### 2.3 カレンダーイベント抽出

- [ ] イベント情報を含むテキストを選択:
  ```
  打ち合わせ
  日時: 2026年2月15日 14:00〜16:00
  場所: 会議室A
  ```
- [ ] 右クリック → 「Context Actions」→「カレンダーイベント抽出」
- [ ] **期待**: イベント情報がJSON形式で表示される
- [ ] 「Googleカレンダーに追加」ボタンをクリック
- [ ] **期待**: Googleカレンダーの新規イベント作成ページが開く

---

### 3. テキストテンプレート

#### 3.1 テンプレート管理

- [ ] Popupを開き「テキストテンプレート」タブに移動（存在する場合）
- [ ] 「新規テンプレート」をクリック
- [ ] 以下を入力:
  - [ ] タイトル: "Thanks"
  - [ ] 内容: "Thank you for your help!"
- [ ] 「保存」をクリック
- [ ] テンプレートリストに表示されることを確認

#### 3.2 テンプレート挿入

- [ ] テキスト入力可能なフィールド（例: GitHub Issue、Gmail）にフォーカス
- [ ] 右クリック → 「テキストテンプレート」→「Thanks」
- [ ] **期待**: テンプレート内容がフィールドに挿入される

---

### 4. リンクコピー機能

#### 4.1 タイトル+URLコピー

- [ ] Popupを開き「リンクコピー」タブに移動
- [ ] **期待**: 現在のタブのタイトルとURLが表示される
- [ ] フォーマット選択:
  - [ ] Markdown: `[タイトル](URL)`
  - [ ] Plain: `タイトル URL`
  - [ ] タイトルのみ
  - [ ] URLのみ
- [ ] 「コピー」ボタンをクリック
- [ ] **期待**: クリップボードにコピーされる
- [ ] テキストエディタに貼り付けて確認

#### 4.2 右クリックメニューからコピー

- [ ] ページ内で右クリック → 「タイトル＋URLをコピー」
- [ ] **期待**: Markdown形式でクリップボードにコピーされる
- [ ] テキストエディタに貼り付けて確認

---

### 5. 検索エンジングループ

#### 5.1 グループ管理

- [ ] Popupを開き「検索エンジングループ」タブに移動（存在する場合）
- [ ] デフォルトグループ（「お買い物」「トレンド」）が表示されることを確認
- [ ] 「新規グループ」をクリック
- [ ] 以下を入力:
  - [ ] グループ名: "Tech"
  - [ ] 検索エンジン: Google, GitHub, Stack Overflow を選択
- [ ] 「保存」をクリック

#### 5.2 グループ検索

- [ ] テキストを選択（例: "React Hooks"）
- [ ] 右クリック → 「検索エンジングループ」→「Tech」
- [ ] **期待**: Google、GitHub、Stack Overflowで新しいタブが開く
- [ ] 各タブで検索結果が表示されることを確認

---

### 6. エラーハンドリング

#### 6.1 無効なAPIトークン

- [ ] 設定タブで無効なトークンを入力
- [ ] 「トークンをテスト」をクリック
- [ ] **期待**: エラーメッセージが表示される（例: "Incorrect API key provided"）

#### 6.2 テキスト選択なし

- [ ] テキストを選択せずに右クリック → 「要約」
- [ ] **期待**: エラー通知が表示される（例: "要約対象のテキストが見つかりませんでした"）

#### 6.3 ネットワークエラー

- [ ] オフライン状態にする
- [ ] Context Actionを実行
- [ ] **期待**: ネットワークエラーのメッセージが表示される

---

### 7. テーマ切り替え

#### 7.1 ライト/ダークテーマ

- [ ] Popupを開く
- [ ] 右上のテーマ切り替えボタン（🌙/☀️）をクリック
- [ ] **期待**: ライト ↔ ダーク ↔ システム設定の順にテーマが切り替わる
- [ ] オーバーレイUIもテーマに従うことを確認

---

### 8. パフォーマンス

#### 8.1 大量テーブル処理

- [ ] 100行以上の大きなテーブルを含むページを開く
- [ ] テーブルソート機能を有効化
- [ ] **期待**: 1秒以内にソートボタンが追加される
- [ ] ソート実行が1秒以内に完了することを確認

#### 8.2 長文要約

- [ ] 5000文字以上の長文を選択
- [ ] 要約を実行
- [ ] **期待**: 20,000文字に制限され、「(以下略)」が追加される
- [ ] 要約結果が30秒以内に表示される

---

## 🐛 バグレポート

テスト中に問題を発見した場合、以下の情報を含めてGitHub Issueを作成してください:

- **環境**:

  - OS: (例: macOS 14.0, Windows 11)
  - Chrome バージョン: (例: 121.0.6167.85)
  - 拡張機能バージョン: (manifest.jsonの"version"を確認)

- **再現手順**:

  1. ...
  2. ...
  3. ...

- **期待される動作**: ...

- **実際の動作**: ...

- **エラーメッセージ** (Console / Network タブのスクリーンショット):
  - ...

---

## ✅ 完了サイン

全てのテストケースにチェックが入ったら、このファイルをコミットしてリファクタリング完了とします。

```bash
git add docs/e2e-test-checklist.md
git commit -m "docs: E2Eテストチェックリストを追加"
```

---

## 📝 更新履歴

- **2026-02-12**: 初版作成
